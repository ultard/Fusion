# Магазин товаров

## Описание

Этот проект представляет собой микросервисное приложение для управления магазином товаров. Система поддерживает
создание, редактирование, удаление и поиск товаров, обработку заказов и уведомлений. Проект реализован с использованием
Fiber, GORM, RabbitMQ и PostgreSQL, а для развертывания используются Docker и Kubernetes.

## Технологии

- **Fiber** — веб-фреймворк для создания высокопроизводительных и минималистичных HTTP-серверов.
- **GORM** — ORM для работы с базой данных PostgreSQL.
- **RabbitMQ** — брокер сообщений для организации очередей, используется для обработки и доставки событий.
- **PostgreSQL** — реляционная база данных для хранения данных о товарах, заказах и клиентах.
- **Docker** — контейнеризация приложения для упрощенного развертывания и масштабирования.
- **Kubernetes** — оркестрация контейнеров для управления микросервисами и поддержания отказоустойчивости.

## Основные возможности

- Управление товарами (создание, редактирование, удаление, поиск).
- Обработка заказов и управление корзиной.
- Отправка уведомлений через RabbitMQ.
- Масштабируемость и отказоустойчивость благодаря Kubernetes.

## Структура проекта

```plaintext
├── app
│   ├── controllers       # Логика обработки запросов и маршрутов
│   ├── models            # Модели GORM для базы данных
│   ├── repositories      # Слой доступа к данным
│   ├── services          # Бизнес-логика
│   ├── routes            # Определение маршрутов для API
│   └── main.go           # Главный файл приложения
├── config                # Конфигурационные файлы приложения
├── Dockerfile            # Dockerfile для создания образа приложения
├── k8s                   # Манифесты Kubernetes для деплоя
└── README.md             # Документация
```

## Запуск проекта

### 1. Предварительные требования

- Docker
- Docker Compose
- Kubernetes (minikube или другая платформа)
- RabbitMQ и PostgreSQL (настраиваются через Docker Compose)

### 2. Установка и запуск в локальной среде

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/yourusername/shop.git
   cd shop
   ```

2. Настройте переменные окружения в файле `.env`:
   ```plaintext
   DB_HOST=postgres
   DB_PORT=5432
   DB_USER=youruser
   DB_PASSWORD=yourpassword
   DB_NAME=shopdb
   RABBITMQ_URL=amqp://guest:guest@rabbitmq:5672/
   ```

3. Соберите Docker-образы и запустите контейнеры:
   ```bash
   docker-compose up --build
   ```

4. Приложение будет доступно по адресу `http://localhost:3000`.

### 3. Развертывание в Kubernetes

1. Настройте Kubernetes-кластер, если он еще не настроен (например, используя `minikube`):
   ```bash
   minikube start
   ```

2. Примените манифесты Kubernetes из директории `k8s/`:
   ```bash
   kubectl apply -f k8s/
   ```

3. Убедитесь, что все поды запущены:
   ```bash
   kubectl get pods
   ```

4. Получите доступ к приложению, используя NodePort или LoadBalancer.

## API-эндпойнты

### Товары

- **GET /products** — Получить список всех товаров
- **GET /products/{id}** — Получить товар по ID
- **POST /products** — Создать новый товар
- **PUT /products/{id}** — Обновить товар по ID
- **DELETE /products/{id}** — Удалить товар по ID

### Заказы

- **GET /orders** — Получить список всех заказов
- **POST /orders** — Создать новый заказ

### Пример запроса

**Создание товара**

```http
POST /products
Content-Type: application/json

{
  "name": "Example Product",
  "description": "This is a product example.",
  "price": 100,
  "stock": 50
}
```

## Тестирование

Для тестирования используйте `curl`, Postman или другой HTTP-клиент. Рекомендуется тестировать основные эндпойнты для
проверки корректности работы приложения.

## Лицензия

Этот проект лицензирован под лицензией MIT. Подробности смотрите в файле LICENSE.